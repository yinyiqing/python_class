{% extends "base.html" %}

{% block page_title %}å®¢æˆ¿ç®¡ç†{% endblock %}

{% block content %}
<style>
    /* çŠ¶æ€æ ‡ç­¾æ ·å¼ */
    .status-badge { padding: 4px 8px; border-radius: 4px; color: white; font-size: 12px; }
    .status-occupied { background-color: #ff4d4f; } /* çº¢è‰²-å·²å…¥ä½ */
    .status-reserved { background-color: #f1c40f; } /* é»„è‰²-å·²é¢„è®¢ */
    .status-free { background-color: #52c41a; }     /* ç»¿è‰²-ç©ºé—² */

    /* è¾…åŠ©æ ·å¼ */
    .table-container { background: var(--bg-card); padding: 20px; border-radius: 8px; margin-top: 20px; }
    .action-btn { margin-right: 5px; }

    /* æœç´¢æ æ ·å¼ä¼˜åŒ– */
    .search-box { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .search-box .form-control { height: 36px; padding: 0 10px; }
</style>

<div class="content-header">
    <div class="header-title">
        <h2><i class="fas fa-bed"></i> å®¢æˆ¿ç®¡ç†</h2>
    </div>
</div>

<div class="content-section">
    <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
        <div class="search-box">
            <input type="text" id="room-search" placeholder="æˆ¿å·..." class="form-control" style="width: 100px;">

            <select id="filter-status" class="form-control" style="width: 110px;">
                <option value="">çŠ¶æ€: å…¨éƒ¨</option>
                <option value="ç©ºé—²">ğŸŸ¢ ç©ºé—²</option>
                <option value="å·²é¢„è®¢">ğŸŸ¡ å·²é¢„è®¢</option>
                <option value="å·²å…¥ä½">ğŸ”´ å·²å…¥ä½</option>
            </select>

            <select id="filter-window" class="form-control" style="width: 110px;">
                <option value="">çª—æˆ·: å…¨éƒ¨</option>
                <option value="1">âœ” æœ‰çª—</option>
                <option value="0">âœ– æ— çª—</option>
            </select>

            <input type="number" id="filter-capacity" placeholder="æœ€å°‘äººæ•°" class="form-control" style="width: 100px;" min="1">

            <button class="btn btn-primary" onclick="searchRooms()">
                <i class="fas fa-search"></i> æœç´¢
            </button>
            <button class="btn btn-secondary" onclick="resetSearch()">
                <i class="fas fa-undo"></i> é‡ç½®
            </button>
        </div>

        <button class="btn btn-success" onclick="showAddRoomModal()">
            <i class="fas fa-plus"></i> æ·»åŠ æˆ¿é—´
        </button>
    </div>

    <div class="table-container">
        <table class="data-table" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="border-bottom: 1px solid #444; text-align: left;">
                    <th style="padding: 12px;">æˆ¿å·</th>
                    <th style="padding: 12px;">ç±»å‹</th>
                    <th style="padding: 12px;">çŠ¶æ€</th>
                    <th style="padding: 12px;">é çª—</th>
                    <th style="padding: 12px;">é¢ç§¯</th>
                    <th style="padding: 12px;">äººæ•°</th>
                    <th style="padding: 12px;">ä»·æ ¼</th>
                    <th style="padding: 12px;">æ“ä½œ</th>
                </tr>
            </thead>
            <tbody id="rooms-table-body">
                </tbody>
        </table>

        <div id="loading-msg" style="text-align: center; padding: 40px; color: #888;">
            <i class="fas fa-spinner fa-spin"></i> åŠ è½½ä¸­...
        </div>

        <div id="no-data-msg" style="text-align: center; padding: 40px; color: #888; display: none;">
            æš‚æ— æˆ¿é—´æ•°æ®
        </div>
    </div>
</div>

<div id="room-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-title">æ·»åŠ æˆ¿é—´</h3>
            <span class="close-modal" style="cursor: pointer; font-size: 24px;">&times;</span>
        </div>
        <div class="modal-body">
            <form id="room-form" onsubmit="handleRoomSave(event)">
                <input type="hidden" id="is_edit" value="false">

                <div class="form-group">
                    <label>æˆ¿å· (ä¸‰ä½æ•°)</label>
                    <input type="text" id="room_number" class="form-control" placeholder="ä¾‹å¦‚: 101" required>
                </div>

                <div class="form-group">
                    <label>æˆ¿å‹</label>
                    <select id="room_type" class="form-control">
                        <option value="å•äººæˆ¿">å•äººæˆ¿</option>
                        <option value="åŒäººæˆ¿">åŒäººæˆ¿</option>
                        <option value="è±ªåå¥—æˆ¿">è±ªåå¥—æˆ¿</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>æˆ¿é—´é¢ç§¯</label>
                    <select id="area" class="form-control">
                        <option value="23">23 å¹³æ–¹ç±³</option>
                        <option value="40">40 å¹³æ–¹ç±³</option>
                        <option value="50">50 å¹³æ–¹ç±³</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>å¯å…¥ä½äººæ•°</label>
                    <input type="number" id="capacity" class="form-control" value="2" min="1" max="10">
                </div>

                <div class="form-group">
                    <label>ä»·æ ¼ (å…ƒ/æ™š)</label>
                    <input type="number" id="price" class="form-control" required>
                </div>

                <div class="form-group" style="display: flex; align-items: center; gap: 10px; margin-top: 15px;">
                    <input type="checkbox" id="has_window" style="width: auto;">
                    <label for="has_window" style="margin: 0;">æˆ¿é—´é çª—</label>
                </div>

                <div class="form-group">
                    <label>æè¿°</label>
                    <textarea id="description" class="form-control" rows="2"></textarea>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary close-modal">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/rooms.js') }}"></script>
{% endblock %}